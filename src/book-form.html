<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="form-line.html">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

<dom-module id="book-form">
  <template>

    <style>

      #container {
        width: 360px;
        height: 550px;
        background-color: #007936;
        padding: 10px;
      }

      #search-button {
        font-family: 'Roboto', sans-serif;
        background-color: rgb(107, 107, 107);
        color: white;
        float: right;
      }

      #search-button:hover {
        background-color: #479C5E;
      }

    </style>

    <iron-ajax
      id="addBook"
      url="http://localhost:9999/SogyoLibrary/rest/book/add"
      content-type="application/json"
      method="POST"
      body={{bookInformation}}
      handle-as="json"
      on-response="handleResponse">
    </iron-ajax>

    <div id="container">
      <form-line id="formLineTitle" name="Titel"></form-line>
      <form-line id="formLineSubtitle" name="Subtitel"></form-line>
      <form-line id="formLineAuthorForename" name="Auteur voornaam"></form-line>
      <form-line id="formLineAuthorSurname" name="Auteur achternaam"></form-line>
      <form-line id="formLineCategory" name="Categorie"></form-line>
      <form-line id="formLinePublisher" name="Uitgever"></form-line>
      <form-line id="formLineYearFirstPublication" name="Publicatiejaar"></form-line>
      <form-line id="formLineISBN" name="ISBN"></form-line>
      <form-line id="formLinePages" name="Bladzijdes"></form-line>
      <form-line id="formLineLanguage" name="Taal"></form-line>

      <paper-button raised id="search-button" on-tap="sendJson">Toevoegen</paper-button>
    </div>

  </template>

  <script>
    Polymer({
      is: "book-form",
      properties: {
        bookInformation: Object,
        successMessage: {
          type: Object,
          notify: true
        }
      },

      sendJson: function() {
        this.bookInformation = {
          title: this.$.formLineTitle.getInputValue(),
          subtitle: this.$.formLineSubtitle.getInputValue(),
          authorForename: this.$.formLineAuthorForename.getInputValue(),
          authorSurname: this.$.formLineAuthorSurname.getInputValue(),
          category: this.$.formLineCategory.getInputValue(),
          publisher: this.$.formLinePublisher.getInputValue(),
          yearFirstPublication: this.$.formLineYearFirstPublication.getInputValue(),
          isbn: this.$.formLineISBN.getInputValue(),
          pages: this.$.formLinePages.getInputValue(),
          language: this.$.formLineLanguage.getInputValue()
        }
        console.log(this.bookInformation);
        console.log(typeof this.successMessage);
        console.log(this.successMessage);
        this.$.addBook.generateRequest();
      },

      handleResponse: function(data) {
        this.successMessage = data.detail.response;
        console.log("handleResponse");
        console.log(typeof this.successMessage)
        console.log(this.successMessage);
      }
    });
  </script>

</dom-module>
